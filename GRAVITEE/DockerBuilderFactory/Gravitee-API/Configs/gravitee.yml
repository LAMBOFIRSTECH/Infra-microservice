############################################################################################################
################################ Gravitee.IO Management API - Configuration ################################
############################################################################################################

############################################################################################
# â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” 
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘ NB : Aucune modification ne doit etre faite dans gravitee.ymlâ•‘
# â•‘Pour chaque nouvelle directives, veuillez la rajouter dans le â•‘
# â•‘sous fichier correspondant.                                   â•‘
# â•‘                                                              â•‘
# â•‘A chaque redÃ©marrage du service `cat *.yml > gravitee.yml`    â•‘
# â•‘               â³â³                                          â•‘
# â•‘Exemple :                                                     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Je souhaite changer le context path de l'api => 04-management-api.yml                 â•‘
# â•‘Je souhaite utiliser elasticsearch pour l'indexation dans gravitee => 05-analytics.ymlâ•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” â›” 
#############################################################################################
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Management : db connect                   â•‘
# â•‘ - Authentification activated                     â•‘
# â•‘ - Enabled SSL/TLS                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
management:
  type: mongodb
  mongodb:
    dbname: ${ds.mongodb.dbname} 
    host: ${ds.mongodb.host} 
    port: ${ds.mongodb.port}
    username: ${ds.mongodb.username}
    password: ${ds.mongodb.password}
    authSource: ${ds.mongodb.authenticationDatabase}
    sslEnabled: true
    sslInvalidHostNameAllowed: false
    # truststore:
    #   path: /path/to/truststore.jks
    #   type: jks
    #   password: changeit
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section API                                       â•‘
# â•‘ - CORS activated                                 â•‘
# â•‘ - Enabled SSL/TLS                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
api:
  http:
    port: 8082
    host: 0.0.0.0
  security:
    enabled: true
  cors:
    allowedOrigins: "*"
    allowedMethods: "GET,POST,PUT,DELETE"
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Gateway :                                 â•‘
# â•‘ - Distributed tracing  activated                 â•‘
# â•‘                                                  â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
gateway:
  http:
    port: 8083
    host: 0.0.0.0
  proxy:
    connectTimeout: 1000
    socketTimeout: 30000
  rateLimit:
    enabled: true
    defaultLimit: 1000
  tracing:
    enabled: true
    provider: jaeger
    endpoint: http://jaeger:14268/api/traces
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Management API :                          â•‘
# â•‘ - CORS activated                                 â•‘
# â•‘ - CONTEXT PATH Enabled SSL/TLS                   â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
management-api:
  http:
    port: 8084
    host: 0.0.0.0
    context-path: /management
  security:
    enabled: true
  cors:
    allowedOrigins: "*"
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Analytics : sent analitics to MongoDB     â•‘
# â•‘ - Authentification activated                     â•‘
# â•‘ - Using proxy.infra.docker (proxy envoy)         â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
analytics:
  type: mongodb
  mongodb:
    hosts:
      - https://proxy.infra.docker:27018
    index: gravitee-all-analytics
    username: ${ds.mongodb.username}
    password: ${ds.mongodb.password}
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Logs :                                    â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
logging:
  level: INFO
  file: /var/log/gravitee-mgnt/apim.log
  format: json
  max-file-size: 10MB
  max-history: 30
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Http server : for GRAVITEE-MANAGEMENT-UI  â•‘
# â•‘ - Enabled gravitee api mangement to speak with UIâ•‘
# â•‘ - Enabled TLS/SSL                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
http:
  port: 8080
  host: 0.0.0.0
  sslEnabled: true
  # sslKeystore:
  #   path: /path/to/keystore.jks
  #   password: changeit
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Tracing :                                 â•‘
# â•‘ - Enabled tracing for gravitee queries           â•‘
# â•‘ - Enabled Jaeger                                 â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
tracing:
  enabled: true
  provider: jaeger
  endpoint: http://jaeger:14268/api/traces
  samplingRate: 1.0
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘ ğŸ” Section Security :                            â•‘
# â•‘ - Enabled JWT for access to api mangement        â•‘
# â•‘ - Enabled oauth2 for access to api mangement     â•‘
# â•‘ - Enabled apiKey for access to api mangement     â•‘
# â•‘ - Enabled CORS                                   â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
security:
  jwt:
    issuer: gravitee.io
    secret: mySuperSecret
    algorithm: HS256
  oauth2:
    enabled: true
  apiKey:
    enabled: true
  cors:
    allowedOrigins: "*"
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Alerting  : sent notification to slack    â•‘
# â•‘ - Enabled slack                                  â•‘
# â•‘ - Enabled TLS/SSL                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
alerting:
  email:
    host: smtp.lamboft.it
    port: 587
    user: gravitee-alerts@lamboft.it
    password: secret
    from: gravitee-alerts@lamboft.it
  slack:
    webhookUrl: https://hooks.slack.com/services/
  webhook:
    url: https://my.alerting.service/notify
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Redis cache  :                            â•‘
# â•‘ - Enabled redis                                  â•‘
# â•‘ - Enabled TLS/SSL                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
cache:
  type: redis
  redis:
    host: redis.infra.docker
    port: 6379
    password: secret
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Plugins  :                                â•‘
# â•‘ - Enabled plugins                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
plugins:
  enabled: true
  pluginFolder: /opt/gravitee-mgnt/plugins
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section export gravitee analytics  :              â•‘
# â•‘ - Enabled                                        â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
analytics-export:
  rabbitmq:
    brokers:
      - rabbitmq:9092
    topic: gravitee-all-analytics
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘Section Clustering  :                             â•‘
# â•‘ - Enabled plugins                                â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
deployment:
  mode: clustered
  nodeId: node-01
